{
    "contents" : "# Calculate race bias by looking at the number of errors on each trial type for each subject\nrequire(dplyr)\nrequire(magrittr)\nrequire(tidyr)\n\ndat = read.delim(\"experimentalTrials.txt\", stringsAsFactors=F)\n\n# 1. First look at WIT trials\nWITdat = dat[dat$Procedure.Block. == \"WITproc\",]\n\nfor (i in 1:nrow(WITdat)) {\n  WITdat$TrialType[i] = paste(WITdat$PrimeType[i],WITdat$TargetType[i], sep = \"_\")\n}\n\n# count errors for each type of trial (out of 48 trials per trial type)\nWITdat$TargetWIT.ACC = as.numeric(WITdat$TargetWIT.ACC)\n\nerrCount = data.frame(\"Subject\" = unique(WITdat$Subject))\n\nfor (i in 1:max(WITdat$Subject)) {\n  tempDat = WITdat[WITdat$Subject == i,]\n  errCount$WITnumCor_bw[errCount$Subject == i] = \n    sum(tempDat$TargetWIT.ACC[tempDat$TrialType == \"black_weapon\"])\n  errCount$WITnumCor_ww[errCount$Subject == i] = \n    sum(tempDat$TargetWIT.ACC[tempDat$TrialType == \"white_weapon\"])\n  errCount$WITnumCor_bt[errCount$Subject == i] = \n    sum(tempDat$TargetWIT.ACC[tempDat$TrialType == \"black_tool\"])\n  errCount$WITnumCor_wt[errCount$Subject == i] = \n    sum(tempDat$TargetWIT.ACC[tempDat$TrialType == \"white_tool\"])\n}\n\n\n\n# 2. Do the same for AP trials\nAPdat = dat[dat$Procedure.Block. == \"APproc\",]\n\nfor (i in 1:nrow(APdat)) {\n  APdat$TrialType[i] = paste(APdat$PrimeType[i],APdat$TargetType[i], sep = \"_\")\n}\n\n# count errors for each type of trial (out of 48 trials per trial type)\nAPdat$TargetAP.ACC = as.numeric(APdat$TargetAP.ACC)\n\nfor (i in 1:max(APdat$Subject)) {\n  tempDat = APdat[APdat$Subject == i,]\n  errCount$APnumCor_bp[errCount$Subject == i] = \n    sum(tempDat$TargetAP.ACC[tempDat$TrialType == \"black_positive\"])\n  errCount$APnumCor_wp[errCount$Subject == i] = \n    sum(tempDat$TargetAP.ACC[tempDat$TrialType == \"white_positive\"])\n  errCount$APnumCor_bn[errCount$Subject == i] = \n    sum(tempDat$TargetAP.ACC[tempDat$TrialType == \"black_negative\"])\n  errCount$APnumCor_wn[errCount$Subject == i] = \n    sum(tempDat$TargetAP.ACC[tempDat$TrialType == \"white_negative\"])\n}\n\n\n# 3. Calculate number of error trials for each condition in both tasks\n\nerrCount$WITnumErr_bw = 48 - errCount$WITnumCor_bw\nerrCount$WITnumErr_ww = 48 - errCount$WITnumCor_ww\nerrCount$WITnumErr_bt = 48 - errCount$WITnumCor_bt\nerrCount$WITnumErr_wt = 48 - errCount$WITnumCor_wt\n\nerrCount$APnumErr_bp = 48 - errCount$APnumCor_bp\nerrCount$APnumErr_wp = 48 - errCount$APnumCor_wp\nerrCount$APnumErr_bn = 48 - errCount$APnumCor_bn\nerrCount$APnumErr_wn = 48 - errCount$APnumCor_wn\n\n# 4. Condense to long version, add descriptive columns/variables\n\nlong = select(errCount, -contains(\"numCor\")) %>%\n  gather(TrialType, numErr,WITnumErr_bw:APnumErr_wn) \n\nlong$GenType[long$TrialType == \"WITnumErr_bw\"] = \"black_con\"\nlong$GenType[long$TrialType == \"APnumErr_bn\"] = \"black_con\"\nlong$GenType[long$TrialType == \"WITnumErr_bt\"] = \"black_incon\"\nlong$GenType[long$TrialType == \"APnumErr_bp\"] = \"black_incon\"\nlong$GenType[long$TrialType == \"WITnumErr_wt\"] = \"white_con\"\nlong$GenType[long$TrialType == \"APnumErr_wp\"] = \"white_con\"\nlong$GenType[long$TrialType == \"WITnumErr_ww\"] = \"white_incon\"\nlong$GenType[long$TrialType == \"APnumErr_wn\"] = \"white_incon\"\n\nlong$Task = NA\nlong$Task[grep(\"WIT\",long$TrialType)] = \"WIT\" \nlong$Task[grep(\"AP\",long$TrialType)] = \"AP\" \n\nlong$ConType = NA\nlong$ConType[grep(\"_con\",long$GenType)] = \"congruent\"\nlong$ConType[grep(\"_incon\",long$GenType)] = \"incongruent\"\n\nlong$RaceType = NA\nlong$RaceType[grep(\"black\",long$GenType)] = \"black\"\nlong$RaceType[grep(\"white\",long$GenType)] = \"white\"\n\nwrite.table(long, file = \"errCountLong.txt\", sep = \"\\t\", row.names = F)\n\n# 5. Plot average errors in each trial across conditions\n\nggplot(long, aes(RaceType, numErr, fill = ConType)) +\n  stat_summary(fun.y = mean, geom = \"bar\", position = \"dodge\") +\n  stat_summary(fun.data = mean_cl_normal, geom = \"errorbar\", position = position_dodge(width=.9), width = .2) +\n  facet_wrap(~Task)\n",
    "created" : 1443823208043.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "888872935",
    "id" : "833110BC",
    "lastKnownWriteTime" : 1443829542,
    "path" : "~/Documents/Projects/Observer study/Data/calcRaceBias.R",
    "project_path" : "calcRaceBias.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}